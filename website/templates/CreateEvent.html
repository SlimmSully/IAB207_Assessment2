{% extends "base.html" %}
{% block title %}Create Event | Poly Beats{% endblock %}
{% block content %}

<main class="container py-4">
  <div class="site-panel p-4 p-lg-5">
    <h2 class="h4 mb-3">Create / Update Event</h2>

    <form method="post" action="{{ url_for('main.CreateEvent') }}" 
      enctype="multipart/form-data" class="row g-3">

      {{ form.csrf_token }}

      <div class="col-md-8">
        {{ form.title.label(class="form-label") }}
        {{ form.title(class="form-control", placeholder="Event Title") }}
      </div>

      <div class="col-md-4">
        {{ form.genre.label(class="form-label") }}
        {{ form.genre(class="form-select") }}
      </div>

      <div class="col-12">
        {{ form.description.label(class="form-label") }}
        {{ form.description(class="form-control", rows="4") }}
      </div>

      <div class="col-md-6">
        {{ form.location.label(class="form-label") }}
        {{ form.location(class="form-control") }}
      </div>

      <div class="col-md-3">
        {{ form.event_date.label(class="form-label") }}
        {{ form.event_date(class="form-control") }}
      </div>

      <div class="col-md-3">
        {{ form.start_time.label(class="form-label") }}
        {{ form.start_time(class="form-control") }}
      </div>

      <div class="col-md-3">
        {{ form.end_time.label(class="form-label") }}
        {{ form.end_time(class="form-control") }}
      </div>

      <div class="col-md-3">
        <label class="form-label fw-semibold">Event Image</label>
        <input type="file" name="img_file" class="form-control" accept="image/*">
      </div>

      <hr class="my-4">
      <h2 class="h4 mb-3">Tickets</h2>

      <div id="ticket-types-wrapper">

        <div class="row g-3 ticket-type-row mb-2">
          <div class="col-md-4">
            <input class="form-control" name="ticket_label[]" placeholder="Label (e.g., Standard)" required>
          </div>
          <div class="col-md-4">
            <input type="number" class="form-control" name="ticket_price[]" placeholder="Price $" min="0" required>
          </div>
          <div class="col-md-4">
            <input type="number" class="form-control" name="ticket_quota[]" placeholder="Quota" min="1" required>
          </div>
        </div>
      </div>

      <button type="button" id="add-ticket-btn" class="btn btn-outline-secondary btn-sm my-2">
        Add another ticket type
      </button>

      <div class="col-12">
        <button type="submit" class="btn btn-dark">Save event</button>
        <a href="{{ url_for('main.index') }}" class="btn btn-outline-secondary">Cancel</a>
      </div>

    </form>
  </div>
</main>

<script>
document.getElementById("add-ticket-btn").addEventListener("click", function () {
  const wrapper = document.getElementById("ticket-types-wrapper");

  const newRow = document.createElement("div");
  newRow.classList.add("row", "g-3", "ticket-type-row", "mb-2");

  newRow.innerHTML = `
    <div class="col-md-4">
      <input class="form-control" name="ticket_label[]" placeholder="Label (e.g., VIP)" required>
    </div>
    <div class="col-md-4">
      <input type="number" class="form-control" name="ticket_price[]" placeholder="Price $" min="0" required>
    </div>
    <div class="col-md-4">
      <input type="number" class="form-control" name="ticket_quota[]" placeholder="Quota" min="1" required>
    </div>
  `;

  wrapper.appendChild(newRow);
});
</script>

{% endblock %}
